<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Matr√≠cula com D√≠gito Verificador</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container">
    <h2>Matr√≠cula com CNM e D√≠gito Verificador</h2>


    <label for="parteFixa">CNS - 1¬∫ Of√≠cio:</label>
    <input type="text" value="" id="parteFixa" />

    <div id="livroContainer" style="display:none;">
      <label for="digitoVariavel">Escolha o Livro:</label>
      <div style="display:flex; gap:20px; justify-content:center; margin-top:8px;">
        <label><input type="radio" name="digitoVariavel" value="2"> 2</label>
        <label><input type="radio" name="digitoVariavel" value="3"> 3</label>
      </div>
    </div>


  <label>Matr√≠cula:</label>
  <input type="text" maxlength="7" id="matricula" />

  <button onclick="calcularDV()">Calcular e Gerar QR</button>
    <p id="resultado"></p>
    <div id="qrcode"></div>
    <button onclick="copiarTexto()">üìã Copiar Matr√≠cula</button>
  </div>

  <script>
    // Detecta primeiro acesso via localStorage
    window.onload = function() {
      const parteFixaInput = document.getElementById('parteFixa');
      const livroContainer = document.getElementById('livroContainer');
      let cnsSalvo = localStorage.getItem('cns');
      if (!cnsSalvo) {
        parteFixaInput.disabled = false;
        parteFixaInput.placeholder = 'Informe o CNS';
        parteFixaInput.value = '';
        parteFixaInput.addEventListener('change', function() {
          if (/^\d{6}$/.test(parteFixaInput.value)) {
            localStorage.setItem('cns', parteFixaInput.value);
            parteFixaInput.disabled = true;
            livroContainer.style.display = 'block';
          } else {
            alert('CNS deve ter 6 d√≠gitos!');
            parteFixaInput.value = '';
          }
        });
      } else {
        parteFixaInput.value = cnsSalvo;
        parteFixaInput.disabled = true;
        livroContainer.style.display = 'block';
      }
    };
  </script>
  </div>

  <!-- Biblioteca QRCode.js -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
  <script src="script.js"></script>
</body>
</html>
